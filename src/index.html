<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>stringmod</title>
  <link rel="stylesheet" href="index.css">
</head>

<body>
  <div class="title-bar">
    <div class="window-title">stringmod</div>
    <div class="title-bar-buttons-left">
      <span class="about-button" id="about-button"><i class="fas fa-ellipsis-h"></i></span>
    </div>
    <div class="title-bar-buttons-right">
      <span class="title-bar-button" id="min-button"><i class="far fa-window-minimize"></i></span>
      <span class="title-bar-button" id="max-button"><i id="max-button-icon" class="far fa-window-maximize"></i></span>
      <span class="title-bar-button close-button" id="close-button"><i class="far fa-window-close"></i></span>
    </div>
  </div>
  <div class="section">
    <!-- <h1 class="title stringmod">stringmod</h1> -->
    <div class="container">
      <div class="columns">
        <div class="column is-half stuff">
          <div class="field">
            <div class="control">
              <input id="StartHex" type="text" class="input" placeholder="Start" oninput="handleStartChange()" />
            </div>
          </div>
          <div class="field">
            <div class="control">
              <input id="OffsetHex" type="text" class="input" placeholder="Offset" oninput="handleOffsetChange()" />
            </div>
          </div>
          <div class="field">
            <div class="control">
              <textarea id="NamesInput" class="input" type="text" placeholder="Names" oninput="handleNamesChange()"
                style="height: 62px;"></textarea>
            </div>
          </div>
          <div class="control">
            <button class="button is-primary" onClick="calculateShit()">Calculate</button>
          </div>
        </div>
        <div class="column is-half">
          <div class="box codebox">
            <div class="copy-container">
              <i id="copy-success-icon" class="fas fa-check copy-success-icon hidden"></i>
              <i id="copy-button" class="far fa-copy copy-icon"></i>
            </div>
            <pre id="output"><code class="hljs javascript">â€¢</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    function calculateShit() {
      const utils = require('./utils');

      var start = document.getElementById("StartHex").value;
      var offset = document.getElementById("OffsetHex").value;
      var names = document.getElementById("NamesInput").value;

      var output = document.getElementById("output");

      window.shit = utils.Calculate(start, offset, names);
      const fuck = utils.SetShit(window.shit);

      console.log(window.shit);
      output.innerHTML = `<code class="hljs javascript">${fuck.value}</code>`;
    }

    function handleStartChange() {
      const utils = require('./utils');

      var start = document.getElementById("StartHex");

      if (!utils.ValidateHex(start.value)) {
        start.className = "input is-danger";
      } else if (event.target.value.charAt(1) === 'X') {
        start.className = "input is-warning";
      } else {
        start.className = "input";
      }
    }

    function handleOffsetChange() {
      const utils = require('./utils');

      var offset = document.getElementById("OffsetHex");

      if (!utils.ValidateHex(offset.value)) {
        offset.className = "input is-danger";
      } else if (event.target.value.charAt(1) === 'X') {
        offset.className = "input is-warning";
      } else {
        offset.className = "input";
      }
    }

    function handleNamesChange() {
      var namesInput = document.getElementById("NamesInput");

      namesInput.style.height = 'auto';

      if (parseInt(namesInput.scrollHeight) < 500) {
        namesInput.style.height = (namesInput.scrollHeight + 2) + 'px';
      } else {
        namesInput.style.height = '500px';
      }
    }

    function copyToClipboard(string) {
      const { clipboard } = require('electron');
      clipboard.writeText(string);
    }
  </script>
  <script>
    (function () {
      const { BrowserWindow } = require('electron').remote
      var maximized = false;
      function init() {
        window.shit = ' ';
        document.getElementById("copy-button").addEventListener("click", function (e) {
          var successIcon = document.getElementById("copy-success-icon");
          copyToClipboard(window.shit);
          successIcon.className = "fas fa-check copy-success-icon visible";
          setTimeout(() => { successIcon.className = "fas fa-check copy-success-icon hidden"; }, 1000);
        });

        document.getElementById("about-button").addEventListener("click", function (e) {
          alert("yep");
        });

        document.getElementById("min-button").addEventListener("click", function (e) {
          var window = BrowserWindow.getFocusedWindow();
          window.minimize();
        });

        document.getElementById("max-button").addEventListener("click", function (e) {
          var window = BrowserWindow.getFocusedWindow();
          if (maximized) {
            window.unmaximize();
            document.getElementById("max-button-icon").className = "far fa-window-maximize";
            maximized = false;
          } else {
            window.maximize();
            document.getElementById("max-button-icon").className = "far fa-window-restore";
            maximized = true;
          }
        });

        document.getElementById("close-button").addEventListener("click", function (e) {
          var window = BrowserWindow.getFocusedWindow();
          window.close();
        });
      };

      document.onreadystatechange = function () {
        if (document.readyState == "complete") {
          init();
        }
      };

    })();
  </script>
</body>

</html>