<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>stringmod</title>
  <link rel="stylesheet" href="index.css">
</head>

<body>
  <div class="title-bar">
    <div class="window-title">stringmod</div>
    <div class="title-bar-buttons-left">
      <span class="about-button" id="about-button"><i class="fas fa-ellipsis-h"></i></span>
    </div>
    <div class="title-bar-buttons-right">
      <span class="title-bar-button" id="min-button"><i class="far fa-window-minimize"></i></span>
      <span class="title-bar-button" id="max-button"><i id="max-button-icon" class="far fa-window-maximize"></i></span>
      <span class="title-bar-button close-button" id="close-button"><i class="far fa-window-close"></i></span>
    </div>
  </div>
  <div class="section">
    <!-- <h1 class="title stringmod">stringmod</h1> -->
    <div class="container">
      <div id="about-modal" class="modal">
        <div class="modal-background"></div>
        <div class="modal-card">
          <header class="modal-card-head">
            <p class="modal-card-title">About stringmod</p>
            <button onClick="closeAboutModal()" class="delete" aria-label="close"></button>
          </header>
          <section class="modal-card-body">
            <p>Developed using <a href="http://electronjs.org">Electron</a>, using <a href="http://bulma.io">Bulma CSS
                framework</a>, and <a href="http://fontawesome.com">Fontawesome</a> icons.</p>
            <p><a href="https://github.com/fooooooooooooooo/stringmod">Source</a></p>
            <p><a href="https://github.com/fooooooooooooooo">Developer</a></p>
          </section>
          <footer class="modal-card-foot">
            :)
          </footer>
        </div>
      </div>
      <div class="columns">
        <div class="column is-half stuff">
          <div class="field">
            <div class="control">
              <input id="StartHex" type="text" class="input" placeholder="Start" oninput="handleStartChange()" />
            </div>
          </div>
          <div class="field">
            <div class="control">
              <input id="OffsetHex" type="text" class="input" placeholder="Offset" oninput="handleOffsetChange()" />
            </div>
          </div>
          <div class="field">
            <div class="control">
              <textarea id="NamesInput" class="input" type="text" placeholder="Names" oninput="handleNamesChange()"
                style="height: 62px;"></textarea>
            </div>
          </div>
          <div class="level">
            <button class="button is-primary" onClick="calculateShit()">Calculate</button>

            <div class="dropdown is-right">
              <div class="dropdown-trigger">
                <button class="button" aria-haspopup="true" aria-controls="dropdown-menu">
                  <span>Size</span>
                  <span class="icon is-small">
                    <i class="fas fa-angle-down" aria-hidden="true"></i>
                  </span>
                </button>
              </div>
              <div class="dropdown-menu" id="dropdown-menu" role="menu">
                <div class="dropdown-content">
                  <a onclick="size2()" id="size2" class="dropdown-item">
                    0x00
                  </a>
                  <a onclick="size3()" id="size3" class="dropdown-item">
                    0x000
                  </a>
                  <a onclick="size4()" id="size4" class="dropdown-item">
                    0x0000
                  </a>
                  <a onclick="size5()" id="size5" class="dropdown-item">
                    0x00000
                  </a>
                  <a onclick="size6()" id="size6" class="dropdown-item">
                    0x000000
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="column is-half">
          <div class="box codebox">
            <div class="copy-container">
              <i id="copy-success-icon" class="fas fa-check copy-success-icon hidden"></i>
              <i id="copy-button" class="far fa-copy copy-icon"></i>
            </div>
            <pre id="output"><code class="hljs javascript">â€¢</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    function size2() {
      changeSize(2);
    }
    function size3() {
      changeSize(3);
    }
    function size4() {
      changeSize(4);
    }
    function size5() {
      changeSize(5);
    }
    function size6() {
      changeSize(6);
    }

    function changeSize(size) {
      document.getElementById(`size${window.padSize}`).classList.remove("is-active");
      document.getElementById(`size${size}`).classList.add("is-active");
      window.padSize = size;
    }

    function closeAboutModal() {
      document.getElementById('about-modal').className = 'modal';
    }

    function calculateShit() {
      const utils = require('./utils');

      var start = document.getElementById("StartHex").value;
      var offset = document.getElementById("OffsetHex").value;
      var names = document.getElementById("NamesInput").value;

      var output = document.getElementById("output");

      window.shit = utils.Calculate(start, offset, names, window.padSize);
      const fuck = utils.SetShit(window.shit);

      console.log(window.shit);
      output.innerHTML = `<code class="hljs javascript">${fuck.value}</code>`;
    }

    function handleStartChange() {
      const utils = require('./utils');

      var start = document.getElementById("StartHex");

      if (!utils.ValidateHex(start.value)) {
        start.className = "input is-danger";
      } else if (event.target.value.charAt(1) === 'X') {
        start.className = "input is-warning";
      } else {
        start.className = "input";
      }
    }

    function handleOffsetChange() {
      const utils = require('./utils');

      var offset = document.getElementById("OffsetHex");

      if (!utils.ValidateHex(offset.value)) {
        offset.className = "input is-danger";
      } else if (event.target.value.charAt(1) === 'X') {
        offset.className = "input is-warning";
      } else {
        offset.className = "input";
      }
    }

    function handleNamesChange() {
      var namesInput = document.getElementById("NamesInput");

      namesInput.style.height = 'auto';

      if (parseInt(namesInput.scrollHeight) < 500) {
        namesInput.style.height = (namesInput.scrollHeight + 2) + 'px';
      } else {
        namesInput.style.height = '500px';
      }
    }

    function copyToClipboard(string) {
      const { clipboard } = require('electron');
      clipboard.writeText(string);
    }
  </script>
  <script>
    const { shell } = require('electron');
    if (document.readyState != "complete") {
      document.addEventListener('DOMContentLoaded', function () {
        prepareTags()
      }, false);
    } else {
      prepareTags();
    }

    function prepareTags() {
      aTags = document.getElementsByTagName("a");
      for (var i = 0; i < aTags.length; i++) {
        if (aTags[i].href.includes('http')) {
          aTags[i].setAttribute("onclick", "shell.openExternal('" + aTags[i].href + "')");
          aTags[i].href = "#";
        }
      }
      return false;
    }
  </script>
  <script>
    // Get all dropdowns on the page that aren't hoverable.
    const dropdowns = document.querySelectorAll('.dropdown:not(.is-hoverable)');

    if (dropdowns.length > 0) {
      // For each dropdown, add event handler to open on click.
      dropdowns.forEach(function (el) {
        el.addEventListener('click', function (e) {
          e.stopPropagation();
          el.classList.toggle('is-active');
        });
      });

      // If user clicks outside dropdown, close it.
      document.addEventListener('click', function (e) {
        closeDropdowns();
      });
    }

    /*
     * Close dropdowns by removing `is-active` class.
     */
    function closeDropdowns() {
      dropdowns.forEach(function (el) {
        el.classList.remove('is-active');
      });
    }

    // Close dropdowns if ESC pressed
    document.addEventListener('keydown', function (event) {
      let e = event || window.event;
      if (e.key === 'Esc' || e.key === 'Escape') {
        closeDropdowns();
      }
    });
  </script>
  <script>
    (function () {
      const { BrowserWindow } = require('electron').remote
      var maximized = false;
      function init() {
        window.shit = ' ';
        window.padSize = 5;
        document.getElementById(`size${window.padSize}`).classList.add("is-active");
        document.getElementById("copy-button").addEventListener("click", function (e) {
          var successIcon = document.getElementById("copy-success-icon");
          copyToClipboard(window.shit);
          successIcon.className = "fas fa-check copy-success-icon visible";
          setTimeout(() => { successIcon.className = "fas fa-check copy-success-icon hidden"; }, 1000);
        });

        document.getElementById("about-button").addEventListener("click", function (e) {
          document.getElementById("about-modal").className = "modal is-active";
        });

        document.getElementById("min-button").addEventListener("click", function (e) {
          var window = BrowserWindow.getFocusedWindow();
          window.minimize();
        });

        document.getElementById("max-button").addEventListener("click", function (e) {
          var window = BrowserWindow.getFocusedWindow();
          if (maximized) {
            window.unmaximize();
            document.getElementById("max-button-icon").className = "far fa-window-maximize";
            maximized = false;
          } else {
            window.maximize();
            document.getElementById("max-button-icon").className = "far fa-window-restore";
            maximized = true;
          }
        });

        document.getElementById("close-button").addEventListener("click", function (e) {
          var window = BrowserWindow.getFocusedWindow();
          window.close();
        });
      };

      document.onreadystatechange = function () {
        if (document.readyState == "complete") {
          init();
        }
      };

    })();
  </script>
</body>

</html>